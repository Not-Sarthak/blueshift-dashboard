import { ArticleSection } from "../../../../components/ArticleSection/ArticleSection";

# Entrypoint

`entrypoint!()` adalah simbol tunggal yang harus diekspor oleh setiap program Solana. Ini adalah titik serah terima di mana runtime Solana melompat dari loader ke dalam kode Anda.

Sebelum lompatan, loader mengemas semua yang dibutuhkan oleh instruksi ke dalam satu catatan bergaya C yang disimpan pada halaman input BPF VM. Makro kemudian membongkar catatan tersebut dan memberikan Rust Anda tiga slice dan referensi yang aman:
- **program_id**: pubkey dari program yang sedang dieksekusi.
- **accounts**: pointer ke array yang berdekatan dari catatan AccountInfo, plus panjangnya.
- **instruction_data**: slice pointer-plus-length dari byte mentah yang disediakan oleh transaksi.

Makro akan:
- Mengubah pointer mentah tersebut menjadi slice Rust yang aman.
- Menangkap panic sehingga menjadi kode `ProgramError::Custom` yang bersih alih-alih membuat VM crash.
- Meneruskan semuanya ke fungsi yang ditentukan pengguna (sering disebut `process_instruction`) yang mengembalikan `ProgramResult`.

Berikut adalah deskripsi tentang catatan tunggal dan datar yang ditempatkan oleh loader Solana di halaman input BPF VM sebelum melompat ke entrypoint Anda.

```rust
pub struct Entrypoint {
    account_len: u64,
    account_info: [AccountRaw; account_len]
    instruction_len: u64,
    instruction_data: [u8; instruction_len]
    program_id: [u8; 32],
}
```

- `account_len`: jumlah akun yang dikirim.
- `account_info`: catatan akun mentah dalam instruksi, satu setelah yang lain.
- `instruction_len`: berapa banyak byte data instruksi yang mengikuti.
- `instruction_data`: instruksi itu sendiri
- `program_id`: 32-byte `Pubkey` dari program yang sedang dijalankan.

Setiap elemen dari array `account_info` kemudian mengikuti tata letak yang sama:

```rust
pub struct AccountRaw {
    is_duplicate: u8,
    is_signer: u8,
    is_writable: u8,
    executable: u8,
    alignment: u32,
    key: [u8; 32],
    owner: [u8; 32],
    lamports: u64,
    data_len: usize,
    data: [u8; data_len],
    padding: [u8; 10_240],
    alignment_padding: [u8; ?],
    rent_epoch: i64,
}
```

- `is_duplicate`: pastikan untuk tidak "mendeserialkan ulang" data jika akun yang sama muncul lebih dari sekali dalam daftar dengan melewatkannya. `0xFF` berarti "unik"; nilai lainnya adalah indeks yang disalin.
- `is_signer` / `is_writable` / `executable`: flag satu byte yang digunakan runtime sehingga program Anda dapat mengatur logika dan CPI tanpa syscall tambahan.
- `alignment`: Slot empat byte placeholder yang menjaga seluruh struct tetap 8-byte aligned. Pinocchio menggunakannya kembali untuk melacak panjang data asli selama reallocs.
- `key` / `owner` / `lamports`: Data minimum yang diperlukan yang harus dimiliki setiap akun.
- `data_len` + `data`: Data dengan panjang variabel yang mungkin dimiliki akun.
- `padding`: Loader mengalokasikan 10_240 byte, ukuran maksimum akun, sehingga data akun dapat berubah dan bertambah di tempat tanpa memindahkan memori.
- `align_padding`: Pengisi tambahan, jika diperlukan, sehingga `AccountRaw` berikutnya tetap dimulai pada batas 8-byte (penting untuk beberapa host eBPF).
- `rent_epoch`: Epoch ketika akun harus membayar sewa berikutnya; dipertahankan untuk kompatibilitas meskipun pengumpulan sewa ditangguhkan.
